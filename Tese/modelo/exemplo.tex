%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Universidade Federal de Santa Catarina             
% Biblioteca Universitária                     
%----------------------------------------------------------------------
% Exemplo de utilização da documentclass ufscThesis
%----------------------------------------------------------------------                                                           
% (c)2013 Roberto Simoni (roberto.emc@gmail.com)
%         Carlos R Rocha (cticarlo@gmail.com)
%         Rafael M Casali (rafaelmcasali@yahoo.com.br)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{ufscThesis} % Definicao do documentclass ufscThesis	

%----------------------------------------------------------------------
% Pacotes usados especificamente neste documento
\usepackage{graphicx} % Possibilita o uso de figuras e gráficos
\usepackage{color}    % Possibilita o uso de cores no documento
\usepackage{pdfpages} % Possibilita a inclusão da ficha catalográfica
\usepackage{listings}
\usepackage[portuguese, ruled, linesnumbered]{algorithm2e}
%----------------------------------------------------------------------
% Comandos criados pelo usuário
\newcommand{\afazer}[1]{{\color{red}{#1}}} % Para destacar uma parte a ser trabalhada
\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}\PackageWarning{TODO:}{#1!}}
%\newcommand{\ABNTbibliographyname}{REFERÊNCIAS} % Necessário para abnTeX 0.8.2

%----------------------------------------------------------------------
% Identificadores do trabalho
% Usados para preencher os elementos pré-textuais
\instituicao[a]{Universidade Federal de Santa Catarina} % Opcional
\departamento[a]{Informática e Estatística}
\curso[o]{Programa de Pós-graduação em Ciência da Computação}
\documento[a]{Tese} % [o] para dissertação [a] para tese
%\titulo{Título}
%\subtitulo{Subtítulo (se houver)} % Opcional
\autor{Isaac Leonardo Santos Sacramento}
\grau{Doutorado}
\local{Florianópolis} % Opcional (Florianópolis é o padrão)
\data{04}{junho}{2016}
\orientador[Orientador\\Universidade Federal de Santa Catarina]{Prof. Dr. Mauro Roisenberg}
%\coorientador[Coorientador\\Universidade ...]{Prof. Dr.}
\coordenador[Coordenador\\Universidade Federal de Santa Catarina]{Profa. Dra. Karina Friedrich Dorneles}

\numerodemembrosnabanca{3} % Isso decide se haverá uma folha adicional
\orientadornabanca{sim} % Se faz parte da banca definir como sim
\coorientadornabanca{nao} % Se faz parte da banca definir como sim
%\bancaMembroA{Primeiro membro\\Universidade ...} %Nome do presidente da banca
%\bancaMembroB{Segundo membro\\Universidade ...}      % Nome do membro da Banca
%\bancaMembroC{Terceiro membro\\Universidade ...}     % Nome do membro da Banca
%\bancaMembroD{Quarto membro\\Universidade ...}       % Nome do membro da Banca
%\bancaMembroE{Quinto membro\\Universidade ...}       % Nome do membro da Banca
%\bancaMembroF{Sexto membro\\Universidade ...}        % Nome do membro da Banca
%\bancaMembroG{Sétimo membro\\Universidade ...}       % Nome do membro da Banca

%\dedicatoria{Este trabalho é dedicado aos meus colegas de classe e aos meus queridos pais.}

%\agradecimento{Inserir os agradecimentos aos colaboradores à execução do trabalho.}

%\epigrafe{Texto da Epígrafe. Citação relativa ao tema do trabalho. É opcional. A epígrafe pode também aparecer na abertura de cada seção ou capítulo.}
%{(Autor da epígrafe, ano)}

\textoResumo {Muitos métodos de simulação multiponto (SMP) têm sido desenvolvidos na última década e são classificados em duas categorias. A primeira, aborda os métodos que mantém
a continuidade das estatísticas clássicas baseadas em variograma. A segunda categoria de algoritmos multiponto é baseada no cálculo de distâncias
entre padrões em uma imagem de treinamento. Imagens de treinamento são bancos de dados de padrões a partir dos quais, estatísticas multiponto, 
incluindo o variograma, podem ser extraídas. Como ferramenta de modelagem, os algoritmos de aprendizado de máquina são universais, adaptativos,
não-lineares, robustos e eficientes. Eles podem alcançar soluções aceitáveis para problemas de classificação, regressão e modelagem de densidade de probabilidade em
espaço de alta dimensão e com características espacialmente referenciados. Neste sentido, se objetiva desenvolver um método, baseado em aprendizagem de máquina,
capaz de gerar simulações a partir do treinamento prévio com imagens de treinamento.
}
\palavrasChave {Estatísticas Multiponto. Redes Neurais.  Amostragem Direta. Simulação Estocástica. Aprendizagem de Máquina.}
 
% \textAbstract {Multiple-point geostatistics has opened a new field of methodologies by which complex geological phenomena have been modeled efficiently.
% Several multiple-point simulation methods have been developed over the last decade. MPS algorithms can be classified in two categories,
% based on their underlying statistical approach. The first category comprises methods that are in the continuity of classical
% variogram-based geostatistics and the second category of MPS algorithms is based on the computation of distances between patterns. 
% }
% \keywords {Multiple-point Statistics. Neural Networks. Direct Sampling. Stochastic Simulation. Machine Learning.}
%----------------------------------------------------------------------
% Início do documento                                
\begin{document}
%--------------------------------------------------------
% Elementos pré-textuais
%\capa  
\folhaderosto[comficha] % Se nao quiser imprimir a ficha, é só não usar o parâmetro
%\folhaaprovacao
%\paginadedicatoria
%\paginaagradecimento
%\paginaepigrafe
\paginaresumo
%\paginaabstract
%\pretextuais % Substitui todos os elementos pre-textuais acima
%\listadefiguras % as listas dependem da necessidade do usuário
%\listadetabelas 
\listadeabreviaturas
%\listadesimbolos
\sumario
%--------------------------------------------------------
% Elementos textuais

\chapter{Introdução}
De acordo com o glossário geoestatístico, geoestatística é a aplicação de métodos estatísticos nas ciências da terra.
\citeonline{journel1990} definem geoestatística como um conjunto de ciências estatísticas que estudam fenômenos espaciais/temporais,
e usam relacionamentos espaciais para modelar valores de variáveis em locais ou tempos não observados, não amostrados. Ou, de maneira mais curta, 
é a quantificação de correlação espacial para ser utilizada posteriormente em simulações\cite{deutsch2002}.
A estatística clássica é dedicada à análise e interpretação de incertezas causadas pela amostragem limitada da propriedade em
estudo. A geoestatística, por outro lado, não é restrita a um modelo de distribuição de população; por exemplo, todas as amostras
de uma população serem normalmente distribuídas e independentes. A maioria dos dados em ciências da terra, como propriedades de rocha,
não satisfazem estas hipóteses, pois possuem correlação espacial. Ou seja, valores de dados de regiões que estão próximas tendem a ser mais
similares que valores de regiões que estão mais afastadas.

\section{Estimativa e Simulação Geoestatística}
A geoestatística provê um conjunto de ferramentas para análise e interpretação de dados no processo de previsão de reservatórios de petróleo,
aquíferos subterrâneos, meios porosos, materiais compósitos, mineração e hidrogeologia. 
As previsões obtidas podem ser de duas formas: estimativa e simulação. Na estimativa (figura \ref{fig:estimacao}),
apenas uma realização, considerada a ideal, da ocorrência espacial é produzida. O resultado obtido é baseado
na amostra de dados e em um modelo, admitido como a representação mais precisa da correlação espacial da amostra de dados, o variograma.
Esta estimativa, também chamada de \emph{maximum a posteriori} (\emph{map}), costuma ser obtida pela técnica de \emph{kriging}. Por outro lado,
na simulação (figura \ref{fig:simulacao}), muitas realizações semelhantes são produzidas usando o mesmo modelo de correlações espaciais 
utilizado na estimativa por \emph{kriging}.
\begin{figure}[!htb]
   \centering
   \caption{Fluxo da estimativa geoestatística.}\label{fig:estimacao}
   \includegraphics[width=0.6\textwidth]{figuras/estimacaokriging.png} \\
   %\small{Fonte: }
\end{figure}

\begin{figure}[!htb]
   \centering
   \caption{Fluxo da simulação geoestatística.}\label{fig:simulacao}
   \includegraphics[width=0.6\textwidth]{figuras/simulacao-geoestatistica.png} \\
   %\small{Fonte: }
\end{figure}

Uma propriedade é estimada para uma localização não amostrada com base nas características
da correlação espacial desta propriedade e nos dados condicionantes (valores existentes em uma localização amostrada), isto é o que difere os
métodos geoestatísticos de uma interpolação simples. Para ilustrar, considere a figura \ref{fig:unknownpoints} como
uma representação da permeabilidade em $n$ locais amostrados. A permeabilidade no ponto desconhecido $z_0$ pode ser
calculada por meio das equações \ref{eq:estimacao} e \ref{eq:pesos} e usando a distância inversa.
No estimador linear $z_0$, cada peso $w_i$ é determinado pela distância do ponto conhecido até o ponto desconhecido.
\begin{equation}
 z_0 = \sum_{i=1}^{n}{w_iz_i} \\
 \label{eq:estimacao}
\end{equation}
\begin{equation}
 w_i = \frac{\frac{1}{d_i}}{\sum_{i=1}^{n}{(\frac{1}{d_i})}}
 \label{eq:pesos}
\end{equation}
\begin{figure}[!htb]
   \centering
   \caption{Cálculo da permeabilidade desconhecida $z_0$ baseado em um conjunto de valores em $n$ locais conhecidos.}\label{fig:unknownpoints}
   \includegraphics[width=0.6\textwidth]{figuras/unknown_points.png} \\
\end{figure}

Tomando como exemplo $n=7$, é possível obter a configuração apresentada na figura \ref{fig:estimation_points} (os valores entre parênteses representam
os pesos dos pontos). Entretanto, do ponto de vista do conhecimento
geológico, a permeabilidade dentro da estrutura de areia deve ser mais similar na direção lateral. Consequentemente, os pontos 4 e 6 devem ter
pesos maiores que os pontos 1 e 2, o que não acontece com o uso da distância invertida. Assim, a informação da correlação espacial não é incorporada
na análise.
De um modo geral a estimativa geoestatística consiste de três etapas:
(1) examinar a similaridade entre as amostras conhecidas por meio da análise de um variograma experimental;
(2) ajustar uma função matemática para o variograma experimental;
(3) realizar uma interpolação por \emph{kriging} baseada nesta função.
Considerando o exemplo mostrado, nos passos 1 e 2 a correlação espacial é incorporada por meio da maior similaridade dos pontos $z_4$ e $z_6$ com o ponto
a ser estimado. Por meio de \emph{kriging}, os pesos dos pontos $z_4$ e $z_6$ se tornam maiores do que os pesos de $z_1$ e $z_2$.
\begin{figure}[!htb]
   \centering
   \caption{Estimativa da permeabilidade desconhecida $z_0$, dados 7 valores conhecidos.}\label{fig:estimation_points}
   \includegraphics[width=0.6\textwidth]{figuras/estimation_points.png} \\
\end{figure}

Os problemas geoestatísticos podem ser sumarizados como ilustrado na figura \ref{fig:imagem_caers}. Para uma realidade física, da qual se dispõe
de uma amostra limitada de dados, é possível obter uma estimativa média por \emph{kriging} ou realizar simulações com estruturas multigaussianas,
de forma a criar múltiplas realizações da realidade física. Ao comparar a imagem da
simulação gaussiana com a imagem da realidade física é possível observa que a simulação não se assemelha com a realidade. Uma questão importante
que emerge desta observação é: como adicionar realismo físico à modelagem estocástica?
\begin{figure}[!htb]
   \centering
   \caption{Processo básico de resolução de um problema geoestatístico.}\label{fig:imagem_caers}
   \includegraphics[width=0.6\textwidth]{figuras/imagem_caers.png} \\
\end{figure}

\section{Simulação Baseada em Variograma}
O variograma é um dispositivo que armazena padrões,
modelado a partir de dados experimentais e reproduzido em cada realização. O sucesso no processo
de simulação geoestatística recai sobre o variograma, que, apesar de ser um conceito matemático, tem pouca
conexão com a realidade. Vários tipos diferentes de heterogeneidades geológicas podem produzir variogramas experimentais
semelhantes \cite{Caers_2004}, como visto na figura \ref{fig:variograma}.
As limitações em capturar a continuidade espacial dos modelos baseados em variograma são amplamente conhecidas
na literatura. Por ser uma estatística que descreve a correlação entre dois pontos quaisquer no espaço, este dispositivo é incapaz de considerar
estruturas curvilíneas e/ou estruturas contínuas em escalas maiores, como canais sinuosos \cite{Arpat2007,Tahmasebi2012}.
\begin{figure}[!htb]
   \centering
   \caption{Três heterogeneidades geológicas diferentes produzem três variogramas semelhantes.}\label{fig:variograma}
   \includegraphics[width=0.6\textwidth]{figuras/variograma.png} \\
   \small{Fonte: \cite{Caers_2004}}
\end{figure}

É comum, em geoestatística, trabalhar com modelo de funções aleatórias, as quais são parte da teoria de probabilidades. 
Nesta abordagem é necessário lidar com conceitos considerados complicados como a noção de expectativa, estacionaridade, domínio infinito e
ergodicidade, para então ser possível realizar uma formulação de que a realidade é uma realização de um processo estocástico. 
Por sua vez, esta realização é decomposta em dois outros problemas: um problema de média e outro de variação em torno desta média; de modo que,
diante de uma simulação geológica, separar o que é a média do que é dado residual pode ser um problema. 
A ferramenta utilizada para modelar sistemas aleatórios e fenômenos espaciais é denominada simulação estocástica condicional, 
seu objetivo é criar representações múltiplas e realísticas de um fenômeno espacial estudado, condicionadas a qualquer dado
disponível.
Cada realização deve refletir a continuidade espacial que se acredita existir, como ilustrado na figura \ref{fig:example-multipoint}.
Os métodos de simulação multiponto (SMP)\abreviatura{SMP}{Simulação Multiponto} surgem da necessidade de capturar informações estruturais
sobre continuidade espacial e tornam possível a comunicação entre física e estatística através do elemento chamado Imagem de Treinamento.
\begin{figure}[!htb]
   \centering
   \caption{Exemplo de simulação multiponto.}\label{fig:example-multipoint}
   \includegraphics[width=0.6\textwidth]{figuras/example-multipoint.png} \\
   \small{Fonte: \cite{Tahmasebi2012}}
\end{figure}

Na seção seguinte estão listados os principais trabalhos relacionados à simulação multiponto. Os algoritmos
de simulação são agrupados baseados em \emph{pixels} e baseados em blocos, e são apresentados em ordem cronológica.
A partir da revisão literária dos algoritmos SMP, é observável a ausência de métodos de aprendizagem de máquina,
capazes de reproduzir os padrões de estruturas espaciais nas realizações e, eventualmente, incorporar ao processo
de simulação o conhecimento apresentado por um especialista .

\chapter{Simulação Multiponto}
Estatística multiponto engloba um conjunto de algoritmos de simulação sequencial que utilizam imagem de
treinamento \abreviatura{IT}{Imagem de Treinamento} como dado de entrada para definir a estrutura espacial de um processo \cite{Guardiano1993,Strebelle2002}. 
As imagens de treinamento são descrições explícitas, 2D ou 3D, da continuidade espacial estudada ou, como
definido por Jef Caers \cite{Caers_2004}, são bancos de dados de padrões a partir dos quais, estatísticas multiponto, incluindo o variograma, podem
ser extraídas. Elas contém informações de múltiplos pontos, são mais intuitivas para não-especialistas, não necessitam ser restritas localmente a
quaisquer dados, não necessitam ter as mesmas dimensões da área estudada, podem ser rejeitadas baseado na análise visual do fenômeno em estudo e
devem refletir um estilo da continuidade espacial similar ao fenômeno real. As figuras \ref{fig:sundarbans} e \ref{fig:3dcathegoricalFolds}
mostram dois exemplos de imagens de treinamento obtidas da biblioteca de imagens disponibilizada por \cite{Mariethoz2014_B}. A figura \ref{fig:sundarbans}
é uma imagem, em duas dimensões, do manguezal arbóreo da região de Sundarbans, Bangladeche. A figura \ref{fig:3dcathegoricalFolds} é a representação em 3 
dimensões de um aquífero aluvial no vale Maules Creek, Austrália.
\begin{figure}[!htb]
   \centering
   \caption{Imagem de satélite 2D da região Sundarbans em Bangladesh.}\label{fig:sundarbans}
   \includegraphics[width=0.6\textwidth]{figuras/2D-imagemsatelite-sundarbans.jpg} \\
   \small{Fonte: http://trainingimages.org/training-images-library.html}
\end{figure}

\begin{figure}[!htb]
   \centering
   \caption{Hidro-fácies em um aquífero aluvial.}\label{fig:3dcathegoricalFolds}
   \includegraphics[width=0.6\textwidth]{figuras/3dhydrofacies.jpg} \\
   \small{Fonte: http://trainingimages.org/training-images-library.html}
\end{figure}

Os métodos tradicionais de simulação se apoiam na modelagem de estatísticas em dois pontos, geralmente as covariâncias e variogramas. Muitos
fenômenos são complexos e inviabilizam a captura de seus padrões espaciais por meio de estatísticas de dois pontos. A simulação
geoestatística multiponto é um método genérico e se
baseia em três mudanças conceituais formalizadas por \cite{Guardiano1993}. A primeira, afirma que conjuntos de dados podem não ser suficiente
para inferir todas as características estatísticas que controlam o que se deseja modelar. A segunda é adotar uma estrutura estatística
não-paramétrica para representar a heterogeneidade. A terceira mudança conceitual é avaliar a estatística de eventos de dados de múltiplos
pontos. As estatísticas multipontos são expressas como funções densidades cumulativas para uma variável aleatória $Z(x)$ condicionadas
a eventos de dados locais $d_n =  {Z(x_1), Z(x_2),...,Z(x_n)}$, isto é, os valores de $Z$ nos nós vizinhos $x_i$ de $x$, equação \ref{eq:1}.
\begin{equation}
 f(z, x, d_n) = Prob({Z(x)<=z|x})
 \label{eq:1}
\end{equation}

Os diferentes algoritmos que compõem este método compartilham elementos comuns, como o uso de um caminho
de simulação (geralmente aleatório), a amostragem em distribuições de probabilidades locais e o uso de grades múltiplas \cite{Mariethoz2014_A}.
Deste modo, alguns algoritmos diferem apenas por um pequeno componente, mas mantém um arquétipo relativamente consistente
e que pode ser descrito como no pseudo-código \ref{alg1}.

 %Código
 \begin{algorithm}[H]
   \SetAlgoLined
   \Entrada{Pelo menos uma variável $Z$ a ser simulada\\ Grade de simulação $SG$, com nós denotados por $x$\\
   Imagem de treinamento $TI$\\ [opcional] Conjunto de pontos de dados condicionais\\ [opcional] mapa local de probabilidade $L$\\ Conjunto de parâmetros específicos do algoritmo} 
   \Saida{$SG$, com $Z$ conhecido em todos os nós}
   \Inicio{
   	Migre os pontos condicionantes para nós correspondentes na grade\\
   	Analise TI para derivar o banco de dados de padrões DB\\
   	Defina um caminho de simulação\\
    
    \Repeat {até critério de parada ser encontrado}{
      Defina o nó $x$ a ser simulado\\
      Encontre $N_x$, a vizinhança de x\\
      Determine a distribuição condicional de $Z(x)$ condicionada a $N_x$ e $L(x)$\\
      Amostre um valor nesta distribuição\\
      Coloque este valor em $SG$\\
     }
     Pós-processamento\\
   }
   \Retorna{$SG$}
   \label{alg1}
   \caption{\textsc{Algoritmo MPS genérico}}
 \end{algorithm}

 \section{Simulação Multiponto Baseada em Pontos}
\citeonline{caers_1998} apresentam um modelo de SMP baseado em redes neurais que utilizam imagens de treinamento
como fonte de aprendizado. Deste modo, as redes neurais podem ser ensinadas a coletar estatísticas de múltiplos pontos e utilizá-las
para gerar modelos probabilísticos condicionados aos dados reais. Para realizar esta tarefa, as distribuições condicionais aprendidas
pela rede, relacionam o valor em qualquer região da imagem aos dados da sua vizinhança, dentro de um \emph{template} centrado na região
simulada, semelhante à ilustração da figura \ref{fig:templates}.
\begin{figure}[!htb]
   \centering
   \caption{Definição de uma vizinhança.}\label{fig:templates}
   \includegraphics[width=0.6\textwidth]{figuras/templates.png} \\
   \small{Fonte: \cite{caers_1998}}
\end{figure}
A rede neural é treinada para determinar os valores de $y$ em qualquer região, dados os valores da vizinhança $x$. Matematicamente,
a rede neural modela a função densidade de probabilidade (FDP) \abreviatura{FDP}{Função Densidade de Probabilidade}
local da equação \ref{eq:a}, ou sua integral, a função de distribuição condicional cumulativa (FDCC) \abreviatura{FDCC}{Função de Distribuição Condicional Cumulativa}.
\begin{equation}
 f(y|x) = Pr({y<Y<y+dy|x})
 \label{eq:a}
\end{equation}

Na fase de treinamento, são inseridos os dados $y$ condicionados a $x$, presentes na imagem de treinamento, e a rede determina o modelo $f(y|x)$.
Na fase de simulação, é percorrido cada nó $i$ dos $N$ nós da grade de simulação e um valor simulado $y_i$ é desenhado, condicionado aos
dados $x_i$ encontrados dentro do \emph{template} definido. A figura \ref{fig:arqrede} apresenta a proposta de rede neural para simulação estocástica
multiponto. Os parâmetros $w$ e $u$ definem a conexão não-linear entre as médias das funções de base radial $RB$ e os dados condicionantes $x$,
$k_1$ é o número de neurônios da primeira camada com função de ativação não-linear $S$, os
$k_2$ é o número de neurônios da segunda camada escondida da rede, a qual recebe adicionalmente os pontos $y$ ponderados
pelos pesos $-(V_{k_2})$. A arquitetura proposta permite interpretar a rede como uma distribuição de mistura de gaussianas e a tarefa de otimização
da rede pode ser realizada com algoritmo de maximização de expectativa.
\begin{figure}[!htb]
   \centering
   \caption{Rede neural que retorna a PDF como saída.}\label{fig:arqrede}
   \includegraphics[width=0.6\textwidth]{figuras/arq_rede_caers.png} \\
   \small{Fonte:\cite{caers_1998}}
\end{figure}

A abordagem multiponto baseada em redes neurais \cite{caers_1998}, fortaleceu o
interesse no estudo dos métodos multipontos. Em 2002, o algoritmo \emph{SNESIM} \cite{Strebelle2002_B} é apresentado como uma alternativa
para realizar simulações sequenciais livres de variogramas e capazes de lidar com a presença de padrões não-estacionários
nas imagens de treinamento. Os autores elucidam que, no lugar de utilizar algum tipo de \emph{kriging} para construir um modelo de
probabilidade para a propriedade a ser simulada, o \emph{SNESIM} determina diretamente o modelo de probabilidades
a partir da imagem de treinamento sem o uso de variogramas.

O método desenvolvido por \citeonline{Strebelle2002_B} realizam simulações com base na computação da distribuição de probabilidade
condicional, derivada a partir da imagem de treinamento e alocada em uma árvore de busca.
Em 2011, \citeonline{Straubhaar2011} apresentaram o método \emph{IMPALA}, que consiste na implementação do método multiponto original, 
com a substituição da árvore de busca por uma estrutura de lista. Este, mais simples, permite reduzir a quantidade de memória RAM utilizada
pelo algoritmo e, consequentemente, utilizar diferentes listas para guardar dados adicionais igualmente utilizados durante a
simulação. Adicionalmente, o uso de diferentes listas facilita a tarefa de paralelização do  algoritmo em \emph{clusters} e
processadores multinúcleos, e permite lidar com a não-estacionaridade na imagem de treinamento e na grade de simulação. \emph{GROWTHSIM} é
um algoritmo similar ao \emph{SNESIM}, exceto pelo uso de um caminho aleatório de vizinhança \cite{Eskandaridalvand201059}.

O número limitado de dados condicionantes ao redor do ponto simulado leva a negligenciar dados que, embora afastados, possuem
informações importantes em escala maior. Com isto, anomalias como desconexões de canais podem ser geradas nas realizações simuladas.
O método proposto em 2005 \cite{Strebelle2005} utiliza mais dados  para condicionamento, especialmente dados localizados distante
do nó simulado. Uma medida de consistência entre as realizações simuladas e a IT é definida baseada no número de vezes que cada dado simulado
teve de ser ignorado para ser capaz de inferir a distribuição de probabilidade condicional no nó.  Uma nova simulação é realizada para os valores
de nós mais inconsistentes, o que permite melhorar a reprodução de padrões de treinamento sem aumento computacional significante.

Em 2010 o algoritmo \emph{simulated annealing} foi implementado com intuito de gerar realizações estocásticas de variáveis
categóricas por reprodução de estatísticas multipontos \cite{Peredo20111110}. A imagem de treinamento é
utilizada para determinar as frequências de ocorrência das configurações de cada nó. Estas frequências são
usadas como estatística alvo que deve combinar com as imagens estocásticas geradas com o algoritmo. Inicialmente é criada uma imagem aleatória
da distribuição espacial das categorias, em seguida, os nós são perturbados aleatoriamente e a diferença entre a estatística alvo e a estatística
atual da imagem é calculada.. A perturbação é aceita se as estatísticas são mais próximas do alvo, ou condicionalmente rejeitada.
A principal relevância deste trabalho está no ganho de performance alcançado com a implementação paralelizada do algoritmo e sua execução sob
um esquema especulativo.

Os algoritmos, \emph{SNESIM} e \emph{IMPALA}, se baseiam no armazenamento dos eventos de dados encontrados na imagem de treinamento, são restritos 
à simulação de variáveis categóricas e necessitam de um modelo para a vizinhança do ponto simulado. Uma nova abordagem para SMP procede com 
amostragens diretamente sobre a imagem de treinamento para um determinado evento, de modo que o uso de um banco de dados de evento se torna 
dispensável \cite{Mariethoz_2010}. O método de amostragem direta permite estender a aplicação de geoestatística multiponto para variáveis contínuas 
e categóricas e se destaca por respeitar a distribuição de probabilidade condicional sem realizar a sua computação. Na utilização de múltiplas 
variáveis, uma função $d$ é escolhida apropriadamente para variáveis categóricas ou contínuas. É possível utilizar a função de distância ($d(.)$) 
para controlar as proporções globais e locais, ou impor uma média local. Para tanto, é adicionado um fator de erro ($E_p$) à fdp, que quantifica a 
diferença entre a probabilidade alvo $L(x)$ e a proporção atual $P\*(x)$ na grade $SG$ parcialmente simulada, na forma da equação \ref{eq:b}.
\begin{equation}
 E_p ~ |P\*(x) - L(x)|
\label{eq:b}
\end{equation}

Em 2012, é apresentado o guia prático para realizações de simulação multiponto com o algoritmo de amostragem direta (DS)\abreviatura{DS}{Direct Sample}
\cite{Meerschman_13}.
Neste trabalho, os autores apresentam uma análise quantitativa sobre os parâmetros de entrada do algoritmo, listam aqueles que são mais importantes,
avaliam seu impacto nas simulações realizadas e demonstram a capacidade do algoritmo em realizar simulações 3D. O trabalho vai além e
apresenta o resultado qualitativo obtido com pós-processamento e o potencial do algoritmo para simular problemas com duas variáveis e reproduzir 
dados condicionantes. Os autores apresentam estratégias para definir os valores adequados para os parâmetros t (\emph{threshold}) e
n (número de vizinhos) nos casos contínuo e categórico. Para este, se recomenda realizar uma etapa de pós-processamento
para remoção de ruído. Em 2013, este método sofreu modificações para simular em bloco, no lugar de simular ponto a ponto.
Esta modificação acelerou a execução do DS em duas ordens de magnitude e permitiu realizar aplicações com
simulações ainda maiores \cite{Rezaee2013293}.

\section{Simulação Multiponto Baseada em Blocos}\label{SMBB}
Uma observação comum na comparação entre a IT e as realizações geradas é a existência de padrões exatamente reproduzidos da IT para a
grade de simulação. Este fenômeno é uma consequência de coerência de textura e o tamanho limitado da imagem de treinamento. Algoritmos de simulação
baseados em fragmentos ou blocos (\emph{patch}) tendem a agrupar valores de simulação que estejam próximos uns dos outros na imagem de treinamento.
O algoritmo de simulação baseada em filtro, \emph{FILTERSIM}, foi concebido para superar a limitação do \emph{SNESIM} em funcionar apenas para
variáveis categóricas.
O \emph{FILTERSIM} agrupa todos os padrões obtidos da IT dentro de um conjunto de classes de padrões e, em cada local de simulação, identifica a
classe de padrão que mais se assemelha ao evento de dado condicionante. Em seguida, um padrão é amostrado dentro do protótipo de padrões e
copiado para a grade de simulação \cite{Zhang2006}. Na versão original do algoritmo, a escolha da classe de padrão é baseada na distância
de pixel entre cada classe de padrão e o evento de dado condicionante, o que torna o algoritmo custoso computacionalmente
para simulações 3D. Entretanto, uma nova abordagem é adotada, na qual o cálculo da distância é substituído por comparação de pontuação de
filtro, ou seja, a diferença da pontuação de filtro entre o padrão condicionante e cada protótipo de padrão \cite{Wu2008}. O cálculo baseado em
pontuação permite reduzir o custo computacional por conta da redução dimensional dos dados.

O algoritmo \emph{SIMPA} \cite{Arpat2007}  abandona a abordagem por reprodução de
estatísticas e reprodução probabilística, e se baseia em reconhecimento de padrões. Neste sentido,
a imagem de treinamento é utilizada como um banco de dados de padrões, nos quais é 
possível identificar entidades com algum significado. Percorrendo um caminho aleatório, o algoritmo atribui a cada localização visitada, um padrão compatível
com os dados locais disponíveis e quaisquer padrões previamente simulados. Assim, todo o padrão é copiado para a grade de simulação.

Cronologicamente próximo ao \emph{SIMPA}, é apresentado à comunidade científica o \emph{Patchwork Simulation} \cite{Ayoub2008}.
Algoritmo de simulação sequencial estocástica, o \emph{SIMPAT} é limitado a variáveis binárias e reproduz propriedades de conectividade e a geometria
de agrupamentos de escala pequena, ou blocos. São estimadas as probabilidades de transição entre blocos adjacentes na imagem de treinamento.
As probabilidades são usadas para simular cada bloco da imagem e cada bloco é conectado ao bloco anteriormente simulado.
O procedimento de conexão dos blocos reproduz estruturas de pequena escala e propriedades de conectividade local. O método apresentou performance
considerada boa em imagens com padrão de tabuleiro de damas ou imagens compostas de pequenos discos. Para estas imagens, a simulação com
\emph{patchwork simulations} alcançou resultados melhores que o algoritmo de Strebelle \cite{Strebelle2002,Strebelle2002_B}.

Diferente dos algoritmos que constroem banco de dados de padrões e pequenos eventos de dados, o \emph{CCSIM} utiliza função de similaridade entre 
o padrão gerado e a imagem de treinamento, de modo a obter realizações que combinem com um evento de dado existente na imagem, isto é, correlação 
cruzada \cite{Tahmasebi2012}. As medidas de correlação cruzada são combinadas com estratégias para reproduzir a continuidade e a reprodutibilidade dos 
padrões. O método \emph{image quilting}\abreviatura{IQ}{Image Quilting} \cite{Efros2001} é idêntico ao \emph{CCSIM}, exceto pelo uso de programação 
dinâmica para realizar, na área de sobreposição, a correção de padrões que não combinam.

\chapter{Redes Neurais Convolucionais}

As redes neurais convolucionais \abreviatura{RNC}{Redes Neurais Convolucionais}, também conhecidas como \emph{Deep Learning}, estão no centro
das pesquisas relacionadas a aprendizagem de máquina. As RNC são muito populares nas áreas de classificação de imagens \cite{Krizhevsky2012,He2014},
visão computacional \cite{Zhangg_2014}, reconhecimento de faces \cite{NyiSun2014}, à segmentação de imagem e reconhecimento de ações em vídeos;
Os fatores que conferem às RNC a importância atual são: (i) a eficiência no treinamento em GPUs modernas, (ii) a proposta das Unidades Lineares Retificadas
(em tradução livre do termo em inglês Rectified Linear Unit - ReLU) \abreviatura{ReLU}{Rectified Linear Unit} as quais tornam a convergência mais rápida, e (iii) o acesso amplo
aos dados para treinamento de modelos extensos (ImageNet)\cite{Krizhevsky2012}.

\section{Deep Learning na Restauração de Imagens}

É possível sumarizar o problema da super-resolução em imagens da seguinte forma: seja a imagem $Y$, é possível obter uma imagem $F(Y)$ que seja
tão similar quanto possível à imagem da realidade geológica de alta resolução $X$? De acordo com \cite{Dong2016}, processo de extrair uma imagem
de alta resolução a partir de outra imagem de menor resolução consiste, conceitualmente, em um
mapeamento que segue os três passos a seguir:

\begin{itemize}
 \item Extração e representação de blocos: consiste na obtenção, a partir da imagem $Y$, dos blocos que possuem sobreposição e
 representar cada bloco como um vetor de alta dimensão. Estes vetores representam um conjunto de mapas de características.
 \item Mapeamento não-linear: mapeamento não-linear de cada vetor de alta dimensão em outro vetor também de alta dimensão.
 Cada vetor mapeado é a representação de um bloco de alta resolução.
 \item Reconstrução: agrega as representações de alta resolução obtida no passo 2 para gerar a imagem de alta resolução final.
 Esta imagem deve ser similar à realidade $X$. 
\end{itemize}

Existe certa similaridade entre o processo de restauração de imagens de alta resolução a partir de imagens de baixa resolução e a simulação geoestatística 
multipontos. Esta semelhança se encontra no fato de ambos os processos utilizarem a análise de blocos da imagem de treinamento e suas sobreposições. Além
disso, o item 3 da listagem anterior se assemelha à etapa interativa da simulação multiponto, que consiste em reconstruir a grade de simulação a partir
dos padrões obtidos da imagem de treinamento.

\chapter{Abordagem de Solução}
A simulação multiponto gera realizações que reproduzam padrões estatísticos inferidos a partir de alguma fonte, usualmente uma imagem de treinamento. 
Como ferramenta de modelagem, os algoritmos de aprendizagem de máquina são universais, adaptativos, não-lineares, robustos e eficientes. 
Eles podem alcançar soluções aceitáveis para problemas de classificação, regressão e modelagem de densidade de probabilidade em espaço de alta dimensão 
e com características espacialmente referenciados. Com base no levantamento literário, se observa a possibilidade de explorar a SMP por meio da 
implementação baseada em aprendizagem de máquina. Dentre os raros trabalhos encontrados estão o uso de algoritmos genéticos 
(GA)\abreviatura{GA}{Genetic Algorithm} na simulação de variáveis categóricas para reproduzir estatísticas multipontos \cite{Peredo2012}. Este algoritmo 
requer alto desempenho computacional e, portanto, depende da disponibilidade de computadores com múltiplos núcleos, bem como unidades de processamentos 
gráficos, características inerentes aos métodos de GA. A simulação multiponto com redes neurais apresentada por Jef Caers \cite{caers_1998} explora uma 
solução neural para a simulação pixel a pixel e, embora haja diversas citações a este trabalho, nenhuma delas está relacionada com a melhoria, expansão 
ou aplicação do método proposto. Este fato se dá, possivelmente, por conta do interesse no desenvolvimento de novos algoritmos, os quais estão 
discriminados na seção anterior.

\bibliographystyle{ufscThesis/ufsc-alf}
\bibliography{bibliografia}

%--------------------------------------------------------
% Elementos pós-textuais
%\apendice
%\chapter{Exemplificando um Apêndice}
%Texto do Apêndice aqui. 

%\anexo
%\chapter{Exemplificando um Anexo}
%Texto do anexo aqui.
\end{document}
